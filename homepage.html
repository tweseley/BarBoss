<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Homepage</title>

    <!-- Bootstrap -->
    <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="homepage.css">

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      <script src="drinks.js"></script>

  </head>

  <body>

    <div class="container">
    	<div class="row">
        <div class="col-xs-6 col-sm-4 col-lg-3">
          <button type="button" style = "margin-left: 50%; margin-top: 75%;" class="btn btn-success">Show Categories</button>
    		</div>
        <div class="col-xs-12 col-sm-8 col-lg-6">
          <div>
            <h1 style = "text-align: center; font-size: 100px; font-family: cursive ">Bar Boss</h1>
          </div>
          <div id="custom-search-input" style = "margin-top: 10%; margin-bottom: 10%">
              <div class="input-group col-md-12" id="search">
                  <input type="text" class="form-control input-lg" placeholder="Search tags or a drink..." id="results"/>
                  <span class="input-group-btn">
                    <a id="href" href="/searchresults.html?">
                      <button class="btn btn-info btn-lg" type="button" onclick="search()">
                          <i class="glyphicon glyphicon-search"></i>
                      </button>
                    </a>
                  </span>
              </div>
          </div>
        </div>

        <div style = "float: right">
          <label id="userName" style = "font-family: georgia; font-weight: 100;"></label>
          <a class="btn btn-primary" href="#" onclick="logout()" style = "margin-left: 20px;">Log Out</a>
    		</div>

    	</div>
    </div>

    <br>

    <div class="container" id="drinksContainer">
    	<div class="flex-row row" id="drinkRow">
    	</div>
    </div>


    <script language="javascript">
        function authenticate() {
            if (sessionStorage.getItem('loggedIn') == null || sessionStorage.getItem('loggedIn') == false) {
                window.location.href = "signin.html";
            }
        }

        function logout() {
            // sessionStorage.clear();
            window.location.href = "signin.html";
        }

        $(document).ready(function()
        {
          authenticate();
          $("#userName").text("Welcome, " + sessionStorage.getItem('userName'));
          populateDrinks();

          $('#results').keyup(function() {
            var href = $('#href');
            var searchHref = $('<a>', {href: "/searchresults.html?results="+$(this).val()});
            href.attr('href', searchHref.attr('href'));
          });
        });

        function populateDrinks() {
          var row = $("#drinkRow");
          for (var i=0; i<drinksList.length; i++) {
            var drink = drinksList[i];
            var container = $('<div>', {"class":"col-xs-6 col-sm-4 col-lg-3"});
            var thumbnail = $('<div>', {class: "thumbnail"});
            var img = $('<img>', {src: drink.url, style: "width: 300px; height:200px"});
            var caption = $('<div>', {class: "caption"});
            var title = $('<h3>').text(drink.name);
            var titleHref = $('<a>', {href: "/drinkcard.html?drink="+drink.href});
            titleHref.append(title);
            var imageHref = $('<a>', {href: "/drinkcard.html?drink="+drink.href});
            imageHref.append(img);
            caption.append(titleHref);
            var num = Math.min(6, drink.tags.length)
            for (var j=0; j<num; j++) {
              var tag = drink.tags[j];
              var button = $('<button>', {class: "btn btn-secondary", type: "button"}).text(tag);
              caption.append(button);
            }
            container.append(thumbnail);
            thumbnail.append(imageHref);
            thumbnail.append(caption);
            row.append(container);
          }
        }



    </script>



  </body>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
